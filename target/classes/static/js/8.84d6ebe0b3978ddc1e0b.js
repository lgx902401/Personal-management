webpackJsonp([8],{"06Db":function(e,t){},"1QoT":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("div",{directives:[{name:"show",rawName:"v-show",value:this.myShowLoadView,expression:"myShowLoadView"}],staticClass:"wx_loading"},[t("div",{staticClass:"ui_hide_loading",staticStyle:{display:"none"},on:{click:this.clickHide}},[this._v("跳过")]),this._v(" "),t("div",{staticClass:"wx_loading_inner"},[t("i",{staticClass:"wx_loading_icon"}),this._v(this._s(this.showTxt)+"\n        ")])])])},staticRenderFns:[]};var l={name:"permissionsDetail",components:{loading:i("VU/8")({replace:!0,props:["showTxt","showLoadView"],data:function(){return{myShowLoadView:this.showLoadView}},methods:{clickHide:function(){this.myShowLoadView=!1}},watch:{showLoadView:function(e){this.myShowLoadView=e}}},s,!1,function(e){i("zDQX")},null,null).exports},data:function(){return{roleItem:{},editFlag:!0,roleId:this.$route.query.id,permsList:[],addPermFlag:!1,permsListAll:[],hasPerms:[],permItem:[],tabLoading:!1,showLoading:!1,propsOption:{multiple:!0,label:"name",value:"permissionId",checkStrictly:!0,disabled:"select",emitPath:!1}}},created:function(){this.getItem(),this.getPerms()},mounted:function(){},methods:{handleChange:function(e){console.log("value",e),console.log("permItem",this.permItem)},back:function(){this.$router.back(-1)},cancelEdit:function(){this.editFlag=!this.editFlag,this.getItem()},saveItem:function(){var e=this,t=this.roleItem;delete t.createTime,delete t.updateTime,post("/pms_api/role/edit",t).then(function(t){e.cancelEdit()}).catch(function(e){console.log(e)})},getItem:function(){var e=this;this.showLoading=!0,post("/pms_api/role/detail?roleId="+this.roleId).then(function(t){e.roleItem=t.data[0],e.showLoading=!1}).catch(function(e){console.log(e)})},getPerms:function(){var e=this;this.tabLoading=!0,post("/pms_api/role/assign/permission/list",{roleId:this.roleId}).then(function(t){e.permsList=t.rows,post("/pms_api/permission/list").then(function(t){for(var i in e.permsListAll=t.rows,e.hasPerms=[],e.permsList)for(var s in e.permsListAll)e.permsList[i].permissionId==e.permsListAll[s].permissionId&&(e.permsListAll[s].select=!0,e.hasPerms.push(e.permsListAll[s].permissionId));var l=[];for(var a in e.permsListAll)0==e.permsListAll[a].type&&(l.push(e.permsListAll[a]),0);for(var o in l)l[o].children=[];for(var r in l)for(var n in e.permsListAll)l[r].id==e.permsListAll[n].parentId&&2==e.permsListAll[n].type&&l[r].children.push(e.permsListAll[n]);for(var c in l)for(var m in l[c].children)l[c].children[m].children=[];for(var d in l)for(var u in l[d].children)for(var p in e.permsListAll)l[d].id==e.permsListAll[p].parentId&&3==e.permsListAll[p].type&&l[d].children[u].children.push(e.permsListAll[p]);e.permsListAll=l,e.tabLoading=!1}).catch(function(t){console.log(t),e.tabLoading=!1})}).catch(function(t){console.log(t),e.tabLoading=!1})},checkPerm:function(e){this.$router.push({path:"/permissionsDetail",query:{id:e.permissionId,title:e.name}})},addPerm:function(){var e=this,t=this.hasPerms;t.push(this.permItem.toString());var i={roleId:this.roleItem.roleId,permissionIdStr:t};post("/pms_api/role/assign/permission",i).then(function(t){e.getPerms(),e.addPermFlag=!e.addPermFlag}).catch(function(e){console.log(e)}),this.permItem=[]},deletePerm:function(e){var t=this;this.$confirm("此操作将取消该角色与权限的绑定，是否继续","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var i=t.hasPerms;delete i[e.$index];var s={roleId:t.roleItem.roleId,permissionIdStr:i};post("/pms_api/role/assign/permission",s).then(function(e){t.getPerms(),t.$message({type:"success",message:"删除成功!"})}).catch(function(e){console.log(e)})}).catch(function(e){})},getPermsAll:function(){},cellStyle:function(e){e.row,e.colum,e.rowIndex,e.columIndex;return"text-align: center"},rowClass:function(e){e.row,e.rowIndex;return"text-align: center"}}},a={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"ui-page"},[i("div",{staticClass:"ui-list ui-box"},[i("div",{staticClass:"box-header ui-list-header"},[i("div",[e._v(e._s(this.$route.query.title)+"详情")]),e._v(" "),i("div",[i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.back}},[e._v("返回")])],1)]),e._v(" "),i("div",{staticClass:"ui-detail-box"},[i("el-form",{staticClass:"ui-search-form",attrs:{"label-width":"120px"}},[i("el-form-item",{attrs:{label:"权限id"}},[i("el-input",{staticClass:"ui-item-reset",attrs:{size:"mini",disabled:""},model:{value:e.roleItem.roleId,callback:function(t){e.$set(e.roleItem,"roleId",t)},expression:"roleItem.roleId"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"名称"}},[i("el-input",{staticClass:"ui-item-reset",attrs:{size:"mini",disabled:e.editFlag},model:{value:e.roleItem.name,callback:function(t){e.$set(e.roleItem,"name",t)},expression:"roleItem.name"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"说明"}},[i("el-input",{staticClass:"ui-item-reset",attrs:{size:"mini",disabled:e.editFlag},model:{value:e.roleItem.description,callback:function(t){e.$set(e.roleItem,"description",t)},expression:"roleItem.description"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"状态"}},[i("el-select",{staticClass:"ui-item-reset",attrs:{placeholder:"请选择",size:"mini",disabled:e.editFlag},model:{value:e.roleItem.status,callback:function(t){e.$set(e.roleItem,"status",t)},expression:"roleItem.status"}},[i("el-option",{attrs:{label:"禁用",value:2}}),e._v(" "),i("el-option",{attrs:{label:"启用",value:1}})],1)],1),e._v(" "),i("el-form-item",{attrs:{label:"创建时间"}},[i("el-input",{staticClass:"ui-item-reset",attrs:{size:"mini",disabled:""},model:{value:e.roleItem.createTime,callback:function(t){e.$set(e.roleItem,"createTime",t)},expression:"roleItem.createTime"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"更新时间"}},[i("el-input",{staticClass:"ui-item-reset",attrs:{size:"mini",disabled:""},model:{value:e.roleItem.updateTime,callback:function(t){e.$set(e.roleItem,"updateTime",t)},expression:"roleItem.updateTime"}})],1)],1),e._v(" "),i("div",{staticClass:"ui-detail-btus"},[e.editFlag?i("el-button",{attrs:{size:"mini"},on:{click:function(t){e.editFlag=!1}}},[e._v("编辑")]):i("el-button",{attrs:{size:"mini"},on:{click:e.cancelEdit}},[e._v("取消")]),e._v(" "),i("el-button",{attrs:{type:"primary",size:"mini",disabled:e.editFlag},on:{click:e.saveItem}},[e._v("保存")])],1)],1)]),e._v(" "),i("div",{staticClass:"ui-list ui-box"},[i("div",{staticClass:"box-header ui-list-header"},[i("div",[e._v("角色关联权限")]),e._v(" "),i("div",[i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){e.addPermFlag=!0}}},[e._v("新增")])],1)]),e._v(" "),i("div",{staticClass:"ui-detail-box"},[i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tabLoading,expression:"tabLoading"}],attrs:{data:e.permsList,"cell-style":e.cellStyle,"header-cell-style":e.rowClass}},[i("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),i("el-table-column",{attrs:{prop:"permissionId",label:"权限id"}}),e._v(" "),i("el-table-column",{attrs:{prop:"name",label:"名称"}}),e._v(" "),i("el-table-column",{attrs:{prop:"url",label:"路径"}}),e._v(" "),i("el-table-column",{attrs:{prop:"status",label:"状态"},scopedSlots:e._u([{key:"default",fn:function(e){return[1==e.row.status?i("el-button",{attrs:{type:"success",icon:"el-icon-check",circle:"",size:"mini"}}):i("el-button",{attrs:{type:"danger",icon:"el-icon-close",circle:"",size:"mini"}})]}}])}),e._v(" "),i("el-table-column",{attrs:{prop:"description",label:"描述"}}),e._v(" "),i("el-table-column",{attrs:{prop:"createTime",label:"创建时间","show-overflow-tooltip":""}}),e._v(" "),i("el-table-column",{attrs:{prop:"updateTime",label:"更新时间","show-overflow-tooltip":""}}),e._v(" "),i("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{attrs:{size:"mini"},on:{click:function(i){return e.checkPerm(t.row)}}},[e._v("详情")]),e._v(" "),i("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(i){return e.deletePerm(t)}}},[e._v("删除")])]}}])})],1)],1)]),e._v(" "),i("el-dialog",{attrs:{title:"请选择要添加的权限",visible:e.addPermFlag},on:{"update:visible":function(t){e.addPermFlag=t}}},[i("el-cascader",{attrs:{options:e.permsListAll,props:e.propsOption,size:"mini"},on:{change:e.handleChange},model:{value:e.permItem,callback:function(t){e.permItem=t},expression:"permItem"}}),e._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{size:"mini"},on:{click:function(t){e.addPermFlag=!1}}},[e._v("取 消")]),e._v(" "),i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.addPerm}},[e._v("确 定")])],1)],1),e._v(" "),e.showLoading?i("loading"):e._e()],1)},staticRenderFns:[]};var o=i("VU/8")(l,a,!1,function(e){i("06Db")},null,null);t.default=o.exports},zDQX:function(e,t){}});
//# sourceMappingURL=8.84d6ebe0b3978ddc1e0b.js.map